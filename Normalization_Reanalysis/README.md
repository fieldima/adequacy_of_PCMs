# The Effect of Normalization on Model Adequacy

## Directory Contents

### Sub-directories

-   Sequences: This directory contains the RNA sequencing data collected from the 5 butterfly species as described in the paper: "" . This data was pulled from Dryad.

-   Scripts: This directory contains the scripts used in this analysis; e.g., downloading sequence data via FTP, Count analysis, etc.

-   Results: This directory contains the read counts of each sample, generated by the Trinity tool.

-   Reference_Transcriptomes: This directory contains the reference transcriptomes of all the butterfly species.

-   Ortho_Assessment: This directory contains the intermediates as well as results of the orthological analysis via the UPhO pipeline.

## Introduction

In this directory, I will be examining the effect of count-normalization on the adequacy of different models from PCMs using the Heliconius Butterflies data set.

## Dependencies

The analyses carried out in this directory require multiple tools, most of which are contained in the conda environment described below. The UPhO repository however, is not contained in this conda environment and should be cloned from the following Github repository: <https://github.com/ballesterus/UPhO>.

The conda environment contains the Trinity Pipeline (insert reference), which itself calls Bowtie, as well as dependencies for UPhO pre-processing such as gnu-parallel, MAFFT, MCL, NCBI-BLAST+, trimAl, RAxML, FastTree, and ETE3. The conda environment can be installed by typing the following command into terminal:

`conda env create --file environment.yml`

## Usage

First, set up the directory structure with:

`bash directory_setup.sh`

The processing and analyses require reference transcriptomes and RNA sequencing data. Reference transcriptomes can be downloaded from: <https://datadryad.org/stash/dataset/doi:10.5061/dryad.ds21fv5>. RNA sequencing data can be downloaded using the get_files.sh script in the Scripts directory:

`bash get_files.sh`

After downloading the transcriptomes and RNA-sequencing data, make sure to activate the conda environment as below:

`conda activate environment`

#### Producing read-count data

Prepare the transcriptomes for read-counting by indexing and then aligning data via bowtie by running the data prep script.

`bash data_prep.sh`

Perform read count analysis by running the multiple read count scripts in the Scripts directory, ideally in parallel. I suggest using `tmux` to make the process run faster.

### Identifying Orthologs via UPhO

Begin preprocessing by following the quick recipe steps provided in the UPhO documentation.

Note: The UPhO scripts will be called from the github directory.

Run the minreID.py script on each of the transcriptomes.

`\Path\to\UPhO\minreID.py transcriptome.fasta Species_Name \|`

Concatenate the FASTA files of all transcriptomes.

`cat *with_id.fasta > AllSeqs.faa`

Perform all vs all BLAST.

`\Path\to\UPhO\minreID.pyBlast_helper.sh -i AllSeqs.faa`
